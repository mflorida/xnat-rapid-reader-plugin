(window["webpackJsonprapid-reader"]=window["webpackJsonprapid-reader"]||[]).push([[0],{26:function(e,t,a){e.exports=a(56)},31:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(22),o=a.n(r),c=(a(31),a(5)),s=a(6),i=a(4),d=window.location.protocol+"//"+window.location.host,m={app:"/read",context:"",host:d,siteUrl:d+"",appUrl:d+"/read"},u=a(7),p=a.n(u);function h(e,t){console.log("useRequest");var a=Object(n.useState)(null),l=Object(i.a)(a,2),r=l[0],o=l[1],c=Object(n.useState)(null),s=Object(i.a)(c,2),d=s[0],m=s[1];return Object(n.useEffect)(function(){!function(){var t=p()(e);m(t),t.then(function(e){return o(e),console.log("useRequest:response"),console.log(e),e})}()},t?[t]:[]),[r,d]}function E(e){return e.req&&e.req.status&&!/^2/.test(e.req.status)?l.a.createElement("div",{className:"card text-white bg-danger mb-3",style:{maxWidth:"24rem"}},l.a.createElement("div",{className:"card-header"},"An Error Occured"),l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},"Status ",e.req.status),l.a.createElement("p",{className:"card-text"},e.req.statusText))):l.a.createElement("div",{className:"spinner-boarder ".concat(e.type?e.type:"text-light"),role:"status"},l.a.createElement("span",{className:"sr-only"},e.text||"Loading..."))}var g=function(e){console.log(e);var t,a=h({url:"".concat(m.siteUrl,"/data/search/saved?format=json&t=").concat(Date.now()),method:"GET"}),n=Object(i.a)(a,2),r=n[0],o=n[1];return l.a.createElement("div",{className:"stored-searches",style:{width:600,margin:"20px auto"}},l.a.createElement("h1",null,"Worklists"),r&&r.data?l.a.createElement("div",{className:"list-group"},(t=r.data).ResultSet&&t.ResultSet.Result?t.ResultSet.Result.map(function(e){if(function(e){return/^(read|worklist)/i.test(e.brief_description)&&/SessionData$/i.test(e.root_element_name)}(e)){var t=e.brief_description.split(/[:|]/),a=e.id,n=(t[2]||"").trim(),r=(t[1]||"").trim();return l.a.createElement(l.a.Fragment,null,l.a.createElement("a",{className:"list-group-item list-group-item-action text-white bg-dark",href:"#/worklists/".concat(a,"/").concat(n)},r))}}):"",console.log(o)):l.a.createElement(E,null))};var f=function(e){var t=e.match.params,a=t.searchId,n=t.templateId,r=h({url:"".concat(m.siteUrl,"/data/search/saved/").concat(a,"/results?format=json&t=").concat(Date.now()),method:"GET"}),o=Object(i.a)(r,2),c=o[0];function d(e){return console.log("resultCount"),e&&e.ResultSet&&e.ResultSet.Result?e.ResultSet.Result.length:0}return o[1],l.a.createElement("div",{className:"stored-search"},c&&c.data?l.a.createElement(l.a.Fragment,null,d(c.data)?l.a.createElement(l.a.Fragment,null,l.a.createElement(s.a,{to:"/worklists/".concat(a,"/").concat(n,"/1/").concat(d(c.data))})):l.a.createElement("i",null,"No results.")):l.a.createElement("small",null,"Loading..."))},x=a(25),w=a.n(x);a(54);function b(e){var t=e.itemData,a=e.templateId,n=(t.expt_id,h({url:"https://phpapi.rsna.org/radreport/v1/templates/".concat(a,"/details"),method:"GET"},a)),r=Object(i.a)(n,2),o=r[0];r[1];return l.a.createElement("form",{id:"form-template-wrapper",action:"#!",style:{paddingTop:"5px"}},o&&o.data&&l.a.createElement(function(){var e=o.data.DATA.templateData.split("<body>")[1].split("</body>")[0];return l.a.createElement("div",{id:"read-form-template",style:{padding:"10px"},dangerouslySetInnerHTML:{__html:w.a.sanitize(e)}})},null),l.a.createElement("br",null),l.a.createElement("input",{name:"project",type:"hidden",defaultValue:t.project}),l.a.createElement("input",{name:"subject",type:"hidden",defaultValue:t.xnat_subjectdata_subjectid}),l.a.createElement("input",{name:"expt_id",type:"hidden",defaultValue:t.expt_id}),l.a.createElement("input",{name:"modality",type:"hidden",defaultValue:t.modality}),l.a.createElement("input",{name:"read_template",type:"hidden",defaultValue:a}),l.a.createElement("textarea",{name:"other",className:"hidden",style:{display:"none"},defaultValue:"{}"}),e.children,void(o&&o.data&&p()({url:"".concat(m.siteUrl,"/data/experiments/").concat(t.expt_id,"/assessors?xsiType=rad:genRadiologyReadData&format=json"),method:"GET"}).then(function(e){return e&&e.data&&e.data.ResultSet&&e.data.ResultSet.Result?e.data.ResultSet.Result:[]}).then(function(e){if(e.length>0){var a=e[e.length-1].ID;p()({url:"".concat(m.siteUrl,"/data/experiments/").concat(t.expt_id,"/assessors/").concat(a,"?format=json"),method:"GET"}).then(function(e){if(e&&e.data&&e.data.items&&e.data.items[0]&&e.data.items[0].data_fields){var t=window.radreportFormData.populate("#form-template-wrapper",e.data.items[0].data_fields);console.log(t)}})}}))&&"")}var v=function(e){var t=e.dataFields,a="VIEWER";return l.a.createElement("div",{id:"viewer-iframe-container",style:{width:"70%",position:"fixed",top:0,right:0,bottom:0,left:0,minHeight:720}},l.a.createElement("iframe",{src:function(){console.log("iframeSrc");var e=["projectId=".concat(t.project),"subjectId=".concat(t.xnat_subjectdata_subjectid),"experimentId=".concat(t.expt_id),"t=".concat(Date.now())];return"".concat(m.siteUrl,"/").concat(a,"/?").concat(e.join("&"))}(),title:t.expt_id,width:"100%",height:"100%",style:{border:"none"}}))};a(55);var y=[{path:"/",exact:!0,page:g,label:"Worklists"},{path:"/worklists",exact:!0,page:g,label:"Worklists"},{path:"/worklists/:searchId/:templateId",exact:!0,page:f,label:"Search Results"},{path:"/worklists/:searchId/:templateId/:searchItemIndex/:searchItemsLength",exact:!0,page:function(e){var t=e.match.params,a=t.searchId,n=t.searchItemIndex,r=t.searchItemsLength,o=e.match.params.templateId;n=+n;var s=h({url:"".concat(m.siteUrl,"/data/search/saved/").concat(a,"/results?format=json&t=").concat(Date.now()),method:"GET",transformResponse:function(e){var t="string"===typeof e?JSON.parse(e):e;return t.ResultSet.Result=t.ResultSet.Result.map(function(e){return e.session_id=e.session_id||e.expt_id,e.expt_id=e.expt_id||e.session_id,e}),console.log(t),t}}),d=Object(i.a)(s,2),u=d[0],g=d[1],f=null;function x(e){return console.log("extractResults"),e&&e.ResultSet&&e.ResultSet.Result?e.ResultSet.Result:[]}function w(e){return console.log("extractItem"),(f=x(e)[n-1]||null).expt_id=f.expt_id||f.session_id,f.subject=f.subject||f.xnat_subjectdata_subjectid,f}function y(e){return console.log("resultCount"),x(e).length}function j(){var e=window.readerConfig.server.info[2].split(/[\/_.:$?=&+\-*]+/);return[e[4]||0,e[1]||0,e[5]||0,e[2]||0,e[3]||0].join("-")}function S(e){var t=e.txt,n=e.newIndex,s=t,i=!1,d="/worklists/".concat(a,"/").concat(o,"/").concat(n,"/").concat(r),m={width:"45%",lineHeight:1.6};return/prev/i.test(t)?(i=n<=0,s=l.a.createElement(l.a.Fragment,null,"\xab Back"),m.float="left"):(s=l.a.createElement(l.a.Fragment,null,"Skip \xbb"),m.float="right",n>r&&(d="/worklists",s="Done")),i?l.a.createElement("button",{disabled:!0,style:m},s):l.a.createElement(c.b,{style:m,to:d},l.a.createElement("button",{style:{width:"100%"}},s))}return l.a.createElement("div",{className:"view-session",style:{margin:0}},u&&u.data?l.a.createElement(l.a.Fragment,null,y(u.data)?l.a.createElement(l.a.Fragment,null,n>y(u.data)||n<=0?l.a.createElement("i",null,"Invalid Session"):l.a.createElement(l.a.Fragment,null,void g.then(function(e){localStorage.setItem("worklist_".concat(a),JSON.stringify(f)),console.log(e)}),w(u.data)&&null,l.a.createElement("div",{className:"clearfix"},l.a.createElement(v,{dataFields:f}),l.a.createElement("div",{id:"session-data",style:{width:"30%",position:"absolute",top:"160px",right:0,bottom:0,overflowY:"scroll",padding:"0 10px"}},l.a.createElement("div",null,l.a.createElement(function(e){var t=e.data,a=(e.itemIndex,w(t));return console.log(a),l.a.createElement("header",{style:{width:"30%",height:160,margin:0,padding:"0 10px",position:"fixed",top:0,right:0,background:"#000",zIndex:1}},l.a.createElement("section",{className:"clearfix",style:{padding:"0 10px",height:40,lineHeight:"40px",verticalAlign:"middle"}},l.a.createElement("div",{className:"float-left"},l.a.createElement(c.b,{to:"/worklists"},l.a.createElement("b",null,l.a.createElement(l.a.Fragment,null,"\xab\xa0"),"Worklists"))),l.a.createElement("div",{className:"float-right"},l.a.createElement("small",null,"Viewing session #",n," of ",r)),l.a.createElement("div",{className:"clearfix"})),l.a.createElement("section",{style:{height:120,margin:"0 10px",padding:"10px",borderBottom:"5px solid #303030",background:"#000"}},l.a.createElement("table",{id:"session-info-table",style:{width:"100%",height:"100%",fontSize:"13px",fontWeight:"bold"}},l.a.createElement("tbody",{style:{border:"none"}},l.a.createElement("tr",null,l.a.createElement("th",null,"Session Label: ",l.a.createElement(l.a.Fragment,null,"\xa0")),l.a.createElement("td",null,a.label)),l.a.createElement("tr",null,l.a.createElement("th",null,"Session ID: ",l.a.createElement(l.a.Fragment,null,"\xa0")),l.a.createElement("td",null,a.expt_id)),l.a.createElement("tr",null,l.a.createElement("th",null,"Subject: ",l.a.createElement(l.a.Fragment,null,"\xa0")),l.a.createElement("td",null,a.subject)),l.a.createElement("tr",null,l.a.createElement("th",null,"Project: ",l.a.createElement(l.a.Fragment,null,"\xa0")),l.a.createElement("td",null,a.project))))))},{data:u.data,itemIndex:n}),l.a.createElement(b,{itemData:f,templateId:o},l.a.createElement("section",{className:"clearfix",style:{padding:"0 20px 30px"}},l.a.createElement(S,{txt:"prev",newIndex:n-1}),l.a.createElement(S,{txt:"next",newIndex:n+1}),l.a.createElement("div",{className:"clearfix"}),l.a.createElement("br",null),l.a.createElement(function(e){var t=e.newIndex,n=t<=r?"/worklists/".concat(a,"/").concat(o,"/").concat(t,"/").concat(r):"/worklists";return l.a.createElement(c.b,{style:{width:"100%",lineHeight:1.6},to:n,onClick:function(e){e.preventDefault(),console.log("link..."),console.log(n);var t=window.radreportFormData.collect("#session-data");console.log(t);var a=window.genRadReadSpawnXML(t.sectionMap);console.log(a.xml),p()({method:"POST",url:"".concat(m.siteUrl,"/data/projects/").concat(f.project,"/subjects/").concat(f.subject,"/experiments/").concat(f.expt_id,"/assessors"),params:{inbody:"true",XNAT_CSRF:j()},headers:{"Content-Type":"text/xml"},data:a.xml}).then(function(e){200===e.status?(console.log("SAVED!!!"),window.location.hash="#".concat(n)):console.warn("error")})}},l.a.createElement("button",{style:{width:"100%"}},"Save and Continue"))},{newIndex:n+1}))),l.a.createElement("table",{style:{display:"none"}},l.a.createElement("tbody",null,Object.keys(f).sort().map(function(e,t){var a=f[e];return l.a.createElement("tr",{className:t%2?"even":"odd"},l.a.createElement("th",null,e),l.a.createElement("td",null,a))})))))))):l.a.createElement("i",null,"No results.")):l.a.createElement(E,{req:g}))},label:"Session Data"}];var j=function(e){return l.a.createElement("div",{className:"not-found text-center",style:{width:600,margin:"0 auto"}},console.log(e),l.a.createElement("h1",null,"Didn't find ur page."),l.a.createElement("div",{className:"alert alert-dark"},'"',window.location.href,'" does not exist'))};var S=function(e){return l.a.createElement("div",{id:"app-wrapper"},l.a.createElement(c.a,null,l.a.createElement(s.d,null,y.map(function(e,t){return e.exact?l.a.createElement(s.b,{exact:!0,path:e.path,component:e.page}):l.a.createElement(s.b,{path:e.path,component:e.page})}),l.a.createElement(s.b,{component:j}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[26,1,2]]]);
//# sourceMappingURL=main.825dfbbb.chunk.js.map